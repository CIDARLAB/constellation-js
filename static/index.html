<html>
  <head>
    <script src="http://imparse.org/js/lib/imparse.js"></script>
    <script src="http://wzrd.in/standalone/uuid%2Fv4@latest"></script>            
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gojs/1.8.2/go-debug.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="../js/ibis.js"></script>

    <!-- <script src="../vendor/codemirror.js"></script> -->
 
    
    <title>Constellation</title>

  </head>
  
  
  <body>
  
      <h3>Constellation</h3>
  
      <textarea id="langInput" style="height: 200px; width:100%" name="paragraph_text" cols="50" rows="10"></textarea>
  
      <input id="submitBtn" type="button" value="Submit">
      <br><br>
  
      <div id="stateGraph" style="border: solid 1px black; width: 100%; height: 400px"></div>
  

      <script>
        var myDiagram = null;
        
        $(document).ready(function() {
          $("#submitBtn").click(function(){
            if (myDiagram) {
              myDiagram.div = null;
            }
           
            myDiagram = initializeStateGraph();
            var numDesigns = 1000;
            var result = ibis($('#langInput').val(), numDesigns);
            displayDiagram(result.stateGraph);

            console.log(result.designs);
          
          });
        });

/* * * * * * * */
/*   DIAGRAM   */
/* * * * * * * */

// Returns an empty Go Diagram object
function initializeStateGraph() {
  
  
    var g = go.GraphObject.make;
    myDiagram = g(go.Diagram, 'stateGraph', {
      initialContentAlignment: go.Spot.Center
    });
  
    return myDiagram;
  }


// Translates adjacency list to Go graph representation
function displayDiagram(stateGraph) {
 

  var nodes = [];
  var edges = [];

  for (id in stateGraph) {
    
    var text = stateGraph[id].text;

    nodes.push({key: id, text: text});
    
    var nodeEdges = stateGraph[id].edges;
    for (var i = 0; i < nodeEdges.length; i++) {
      edges.push({from: id, to: nodeEdges[i]});
    }
  }

  
  // var root = getRootNode(stateGraph);
  // // for graph clarity purposes
  // root.text = 'root';  
  myDiagram.model = new go.GraphLinksModel(nodes, edges);
}
            
      </script>
  </body>


  
  </html>